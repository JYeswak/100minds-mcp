=== OPTIMIZATION ROUND 4: Thompson optimization ===
